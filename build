#!/usr/bin/env sh
set -ex # Stop on first error and log all commands

CC="cc"
CFLAGS="-Wall -Werror -Wextra -Wshadow -Wmissing-declarations -Wswitch-enum -pedantic -std=c99 -ggdb"

# Build libs
cd lib && $CC $CFLAGS -c *.c && cd ..

# Build and run tests
$CC $CFLAGS -o test/uri.t  test/uri.t.c  lib/*.o && ./test/uri.t
$CC $CFLAGS -o test/past.t test/past.t.c lib/*.o && ./test/past.t
$CC $CFLAGS -o test/tab.t  test/tab.t.c  lib/*.o && ./test/tab.t

# Build main program
$CC $CFLAGS -o yupa main.c lib/*.o
